<ion-header [translucent]="true">
  <ion-toolbar color="primary">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/catalogo-publico"></ion-back-button>
    </ion-buttons>
    <ion-title>Crear Cuenta - Tigo Conecta</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="ion-padding">
  <div class="register-container">
    <!-- Logo -->
    <div class="logo-container">
      <ion-icon name="person-add-outline" style="font-size: 80px; color: var(--ion-color-primary);"></ion-icon>
      <h1>Regístrate</h1>
      <p>Crea tu cuenta y disfruta de nuestros planes</p>
    </div>

    <!-- Formulario -->
    <form [formGroup]="registerForm" (ngSubmit)="onRegister()">
      
      <!-- Nombre Completo -->
      <ion-item lines="full">
        <ion-label position="floating">Nombre Completo *</ion-label>
        <ion-input 
          type="text" 
          formControlName="nombreCompleto"
          autocomplete="name"
        ></ion-input>
      </ion-item>
      <ion-note 
        color="danger" 
        *ngIf="nombreCompleto?.invalid && nombreCompleto?.touched"
      >
        <span *ngIf="nombreCompleto?.errors?.['required']">El nombre es requerido</span>
        <span *ngIf="nombreCompleto?.errors?.['minlength']">Mínimo 3 caracteres</span>
      </ion-note>

      <!-- Email -->
      <ion-item lines="full">
        <ion-label position="floating">Correo Electrónico *</ion-label>
        <ion-input 
          type="email" 
          formControlName="email"
          autocomplete="email"
        ></ion-input>
      </ion-item>
      <ion-note 
        color="danger" 
        *ngIf="email?.invalid && email?.touched"
      >
        <span *ngIf="email?.errors?.['required']">El correo es requerido</span>
        <span *ngIf="email?.errors?.['email']">Ingresa un correo válido</span>
      </ion-note>

      <!-- Teléfono -->
      <ion-item lines="full">
        <ion-label position="floating">Teléfono (10 dígitos) *</ion-label>
        <ion-input 
          type="tel" 
          formControlName="telefono"
          autocomplete="tel"
          maxlength="10"
        ></ion-input>
      </ion-item>
      <ion-note 
        color="danger" 
        *ngIf="telefono?.invalid && telefono?.touched"
      >
        <span *ngIf="telefono?.errors?.['required']">El teléfono es requerido</span>
        <span *ngIf="telefono?.errors?.['pattern']">Debe tener 10 dígitos numéricos</span>
      </ion-note>

      <!-- Contraseña -->
      <ion-item lines="full">
        <ion-label position="floating">Contraseña *</ion-label>
        <ion-input 
          [type]="showPassword ? 'text' : 'password'" 
          formControlName="password"
          autocomplete="new-password"
        ></ion-input>
        <ion-button 
          slot="end" 
          fill="clear" 
          (click)="togglePassword()"
        >
          <ion-icon [name]="showPassword ? 'eye-off' : 'eye'"></ion-icon>
        </ion-button>
      </ion-item>
      <ion-note 
        color="danger" 
        *ngIf="password?.invalid && password?.touched"
      >
        <span *ngIf="password?.errors?.['required']">La contraseña es requerida</span>
        <span *ngIf="password?.errors?.['minlength']">Mínimo 6 caracteres</span>
      </ion-note>

      <!-- Confirmar Contraseña -->
      <ion-item lines="full">
        <ion-label position="floating">Confirmar Contraseña *</ion-label>
        <ion-input 
          [type]="showConfirmPassword ? 'text' : 'password'" 
          formControlName="confirmPassword"
          autocomplete="new-password"
        ></ion-input>
        <ion-button 
          slot="end" 
          fill="clear" 
          (click)="toggleConfirmPassword()"
        >
          <ion-icon [name]="showConfirmPassword ? 'eye-off' : 'eye'"></ion-icon>
        </ion-button>
      </ion-item>
      <ion-note 
        color="danger" 
        *ngIf="confirmPassword?.invalid && confirmPassword?.touched"
      >
        <span *ngIf="confirmPassword?.errors?.['required']">Confirma tu contraseña</span>
        <span *ngIf="confirmPassword?.errors?.['passwordMismatch']">Las contraseñas no coinciden</span>
      </ion-note>

      <!-- Información del rol -->
      <ion-card style="margin-top: 15px; background-color: #e3f2fd;">
        <ion-card-content>
          <ion-icon name="information-circle-outline" color="primary"></ion-icon>
          <span style="margin-left: 8px;">
            Tu cuenta será creada con rol de <strong>Usuario Registrado</strong>
          </span>
        </ion-card-content>
      </ion-card>

      <!-- Botón Registrarse -->
      <ion-button 
        expand="block" 
        type="submit"
        [disabled]="registerForm.invalid"
        style="margin-top: 20px;"
      >
        Crear Cuenta
      </ion-button>
    </form>

    <!-- Divider -->
    <div style="text-align: center; margin: 20px 0;">
      <span style="color: #666;">o</span>
    </div>

    <!-- Botón ver catálogo -->
    <ion-button 
      expand="block" 
      fill="outline" 
      (click)="goToCatalogo()"
    >
      Ver catálogo sin registrarme
    </ion-button>

    <!-- Link a Login -->
    <div style="text-align: center; margin-top: 20px;">
      <p>
        ¿Ya tienes cuenta? 
        <ion-button fill="clear" (click)="goToLogin()" style="text-transform: none;">
          Inicia sesión
        </ion-button>
      </p>
    </div>
  </div>
</ion-content>